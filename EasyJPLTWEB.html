<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT Kanji Dictionary & Quiz</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Markdown Parser (Marked) for AI response formatting -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Sarabun', sans-serif;
        }

        .perspective-1000 {
            perspective: 1000px;
        }
        
        .preserve-3d {
            transform-style: preserve-3d;
        }
        
        .backface-hidden {
            backface-visibility: hidden;
        }
        
        .rotate-y-180 {
            transform: rotateY(180deg);
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }

        @keyframes slide-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-slide-up {
            animation: slide-up 0.4s ease-out forwards;
        }

        /* Custom Scrollbar for Chat */
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        
        /* Markdown Styles within AI Response */
        .ai-response p { margin-bottom: 0.5em; }
        .ai-response ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .ai-response ol { list-style-type: decimal; padding-left: 1.2em; margin-bottom: 0.5em; }
        .ai-response strong { font-weight: 700; color: #475569; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useRef } = React;

        // --- Icons Components (SVG) ---
        const Search = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        );
        const BookOpen = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );
        const LayoutList = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/><path d="M14 4h7"/><path d="M14 9h7"/><path d="M14 15h7"/><path d="M14 20h7"/></svg>
        );
        const RefreshCw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
        );
        const GraduationCap = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
        );
        const ChevronLeft = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m15 18-6-6 6-6"/></svg>
        );
        const ChevronRight = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m9 18 6-6-6-6"/></svg>
        );
        const CheckCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>
        );
        const XCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
        );
        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        );
        const Settings = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
        );
        const Lightbulb = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
        );
        const Sparkles = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 19v4"/><path d="M15 21h4"/></svg>
        );
        const Send = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
        );
        const MessageCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/></svg>
        );


        // --- Data ---
        const rawData = [
          { char: '私', on: 'SHI', kun: 'watashi', meaning: 'ฉัน', category: 'บุคคล', example: '私は学生です。', exampleReading: 'Watashi wa gakusei desu.', exampleMeaning: 'ฉันเป็นนักเรียน' },
          { char: '男', on: 'DAN, NAN', kun: 'otoko', meaning: 'ผู้ชาย', category: 'บุคคล', example: 'あの男の人は誰ですか。', exampleReading: 'Ano otoko no hito wa dare desu ka.', exampleMeaning: 'ผู้ชายคนนั้นคือใคร' },
          { char: '本', on: 'HON', kun: 'moto', meaning: 'หนังสือ', category: 'สิ่งของ', example: 'これは私の本です。', exampleReading: 'Kore wa watashi no hon desu.', exampleMeaning: 'นี่คือหนังสือของฉัน' },
          { char: '中', on: 'CHUU', kun: 'naka', meaning: 'ข้างใน', category: 'ตำแหน่ง', example: '箱の中に猫がいます。', exampleReading: 'Hako no naka ni neko ga imasu.', exampleMeaning: 'มีแมวอยู่ในกล่อง' },
          { char: '大', on: 'DAI, TAI', kun: 'oo(kii)', meaning: 'ใหญ่', category: 'ขนาด', example: '象は大きいです。', exampleReading: 'Zou wa ookii desu.', exampleMeaning: 'ช้างตัวใหญ่' },
          { char: '小', on: 'SHOU', kun: 'chii(sai)', meaning: 'เล็ก', category: 'ขนาด', example: 'この靴は小さいです。', exampleReading: 'Kono kutsu wa chiisai desu.', exampleMeaning: 'รองเท้าคู่นี้เล็ก' },
          { char: '上', on: 'JOU', kun: 'ue', meaning: 'บน', category: 'ตำแหน่ง', example: '机の上にペンがあります。', exampleReading: 'Tsukue no ue ni pen ga arimasu.', exampleMeaning: 'มีปากกาอยู่บนโต๊ะ' },
          { char: '下', on: 'KA, GE', kun: 'shita', meaning: 'ล่าง', category: 'ตำแหน่ง', example: '椅子の下に犬がいます。', exampleReading: 'Isu no shita ni inu ga imasu.', exampleMeaning: 'มีสุนัขอยู่ใต้เก้าอี้' },
          { char: '左', on: 'SA', kun: 'hidari', meaning: 'ซ้าย', category: 'ทิศทาง', example: '左に曲がってください。', exampleReading: 'Hidari ni magatte kudasai.', exampleMeaning: 'กรุณาเลี้ยวซ้าย' },
          { char: '右', on: 'U, YUU', kun: 'migi', meaning: 'ขวา', category: 'ทิศทาง', example: '右を見てください。', exampleReading: 'Migi o mite kudasai.', exampleMeaning: 'กรุณามองทางขวา' },
          { char: '今', on: 'KON, KIN', kun: 'ima', meaning: 'ตอนนี้', category: 'เวลา', example: '今は何時ですか。', exampleReading: 'Ima wa nanji desu ka.', exampleMeaning: 'ตอนนี้กี่โมงแล้ว' },
          { char: '年', on: 'NEN', kun: 'toshi', meaning: 'ปี', category: 'เวลา', example: '来年日本へ行きます。', exampleReading: 'Rainen Nihon e ikimasu.', exampleMeaning: 'ปีหน้าจะไปญี่ปุ่น' },
          { char: '時', on: 'JI', kun: 'toki', meaning: 'เวลา', category: 'เวลา', example: '時間がありますか。', exampleReading: 'Jikan ga arimasu ka.', exampleMeaning: 'มีเวลาไหม' },
          { char: '分', on: 'FUN, BUN', kun: 'wa(keru)', meaning: 'นาที', category: 'เวลา', example: 'あと五分で着きます。', exampleReading: 'Ato gofun de tsukimasu.', exampleMeaning: 'อีก 5 นาทีจะถึง' },
          { char: '半', on: 'HAN', kun: 'naka(ba)', meaning: 'ครึ่ง', category: 'ปริมาณ', example: '三時半に会いましょう。', exampleReading: 'Sanji han ni aimashou.', exampleMeaning: 'เจอกันตอน 3 โมงครึ่ง' },
          { char: '前', on: 'ZEN', kun: 'mae', meaning: 'หน้า', category: 'ตำแหน่ง', example: '駅の前にいます。', exampleReading: 'Eki no mae ni imasu.', exampleMeaning: 'อยู่หน้าสถานี' },
          { char: '後', on: 'GO, KOU', kun: 'ato', meaning: 'หลัง', category: 'ตำแหน่ง', example: '後で電話します。', exampleReading: 'Ato de denwa shimasu.', exampleMeaning: 'จะโทรหาทีหลัง' },
          { char: '午', on: 'GO', kun: '-', meaning: 'เที่ยง', category: 'เวลา', example: '午後から雨です。', exampleReading: 'Gogo kara ame desu.', exampleMeaning: 'ช่วงบ่ายฝนจะตก' },
          { char: '外', on: 'GAI, GE', kun: 'soto', meaning: 'ข้างนอก', category: 'ตำแหน่ง', example: '外は寒いです。', exampleReading: 'Soto wa samui desu.', exampleMeaning: 'ข้างนอกหนาว' },
          { char: '国', on: 'KOKU', kun: 'kuni', meaning: 'ประเทศ', category: 'สถานที่', example: 'お国はどちらですか。', exampleReading: 'Okuni wa dochira desu ka.', exampleMeaning: 'ประเทศของคุณคือที่ไหน' },
          { char: '語', on: 'GO', kun: 'kata(ru)', meaning: 'ภาษา', category: 'การกระทำ', example: '日本語を勉強しています。', exampleReading: 'Nihongo o benkyou shiteimasu.', exampleMeaning: 'กำลังเรียนภาษาญี่ปุ่น' },
          { char: '名', on: 'MEI, MYOU', kun: 'na', meaning: 'ชื่อ', category: 'บุคคล', example: '名前を書いてください。', exampleReading: 'Namae o kaite kudasai.', exampleMeaning: 'กรุณาเขียนชื่อ' },
          { char: '電', on: 'DEN', kun: '-', meaning: 'ไฟฟ้า', category: 'พลังงาน', example: '電気を消してください。', exampleReading: 'Denki o keshite kudasai.', exampleMeaning: 'กรุณาปิดไฟ' },
          { char: '話', on: 'WA', kun: 'hana(su)', meaning: 'พูด', category: 'การกระทำ', example: '先生と話しました。', exampleReading: 'Sensei to hanashimashita.', exampleMeaning: 'คุยกับคุณครูแล้ว' },
          { char: '食', on: 'SHOKU', kun: 'ta(beru)', meaning: 'กิน', category: 'การกระทำ', example: 'ご飯を食べます。', exampleReading: 'Gohan o tabemasu.', exampleMeaning: 'กินข้าว' },
          { char: '飲', on: 'IN', kun: 'no(mu)', meaning: 'ดื่ม', category: 'การกระทำ', example: '水を飲みます。', exampleReading: 'Mizu o nomimasu.', exampleMeaning: 'ดื่มน้ำ' },
          { char: '読', on: 'DOKU', kun: 'yo(mu)', meaning: 'อ่าน', category: 'การกระทำ', example: '本を読みます。', exampleReading: 'Hon o yomimasu.', exampleMeaning: 'อ่านหนังสือ' },
          { char: '書', on: 'SHO', kun: 'ka(ku)', meaning: 'เขียน', category: 'การกระทำ', example: '手紙を書きます。', exampleReading: 'Tegami o kakimasu.', exampleMeaning: 'เขียนจดหมาย' },
          { char: '見', on: 'KEN', kun: 'mi(ru)', meaning: 'ดู', category: 'การกระทำ', example: '映画を見ました。', exampleReading: 'Eiga o mimashita.', exampleMeaning: 'ดูหนังแล้ว' },
          { char: '聞', on: 'BUN, MON', kun: 'ki(ku)', meaning: 'ฟัง', category: 'การกระทำ', example: '音楽を聞きます。', exampleReading: 'Ongaku o kikimasu.', exampleMeaning: 'ฟังเพลง' },
          { char: '行', on: 'KOU, GYOU', kun: 'i(ku)', meaning: 'ไป', category: 'การกระทำ', example: '学校へ行きます。', exampleReading: 'Gakkou e ikimasu.', exampleMeaning: 'ไปโรงเรียน' },
          { char: '来', on: 'RAI', kun: 'ku(ru)', meaning: 'มา', category: 'การกระทำ', example: '明日来てください。', exampleReading: 'Ashita kite kudasai.', exampleMeaning: 'พรุ่งนี้กรุณามาด้วย' },
          { char: '出', on: 'SHUTSU', kun: 'de(ru)', meaning: 'ออก', category: 'การกระทำ', example: '家を出ます。', exampleReading: 'Ie o demasu.', exampleMeaning: 'ออกจากบ้าน' },
          { char: '入', on: 'NYUU', kun: 'hai(ru)', meaning: 'เข้า', category: 'การกระทำ', example: '部屋に入ります。', exampleReading: 'Heya ni hairimasu.', exampleMeaning: 'เข้าห้อง' },
          { char: '立', on: 'RITSU', kun: 'ta(tsu)', meaning: 'ยืน', category: 'การกระทำ', example: 'ここに立ってください。', exampleReading: 'Koko ni tatte kudasai.', exampleMeaning: 'กรุณายืนตรงนี้' },
          { char: '休', on: 'KYUU', kun: 'yasu(mu)', meaning: 'พัก', category: 'การกระทำ', example: '少し休みましょう。', exampleReading: 'Sukoshi yasumimashou.', exampleMeaning: 'พักสักหน่อยเถอะ' },
          { char: '校', on: 'KOU', kun: '-', meaning: 'โรงเรียน', category: 'สถานที่', example: '高校生です。', exampleReading: 'Koukousei desu.', exampleMeaning: 'เป็นนักเรียนมัธยมปลาย' },
          { char: '高', on: 'KOU', kun: 'taka(i)', meaning: 'สูง', category: 'ขนาด', example: 'あの山は高いです。', exampleReading: 'Ano yama wa takai desu.', exampleMeaning: 'ภูเขาลูกนั้นสูง' },
          { char: '安', on: 'AN', kun: 'yasu(i)', meaning: 'ถูก', category: 'สถานะ', example: 'この服は安いです。', exampleReading: 'Kono fuku wa yasui desu.', exampleMeaning: 'เสื้อตัวนี้ราคาถูก' },
          { char: '新', on: 'SHIN', kun: 'atara(shii)', meaning: 'ใหม่', category: 'สถานะ', example: '新しい車を買いました。', exampleReading: 'Atarashii kuruma o kaimashita.', exampleMeaning: 'ซื้อรถใหม่แล้ว' },
          { char: '古', on: 'KO', kun: 'furu(i)', meaning: 'เก่า', category: 'สถานะ', example: 'これは古い本です。', exampleReading: 'Kore wa furui hon desu.', exampleMeaning: 'นี่คือหนังสือเก่า' },
          { char: '長', on: 'CHOU', kun: 'naga(i)', meaning: 'ยาว', category: 'ขนาด', example: '髪が長いです。', exampleReading: 'Kami ga nagai desu.', exampleMeaning: 'ผมยาว' },
          { char: '友', on: 'YUU', kun: 'tomo', meaning: 'เพื่อน', category: 'บุคคล', example: '友達と遊びます。', exampleReading: 'Tomodachi to asobimasu.', exampleMeaning: 'เล่นกับเพื่อน' },
          { char: '父', on: 'FU', kun: 'chichi', meaning: 'พ่อ', category: 'บุคคล', example: '父は会社員です。', exampleReading: 'Chichi wa kaishain desu.', exampleMeaning: 'พ่อเป็นพนักงานบริษัท' },
          { char: '母', on: 'BO', kun: 'haha', meaning: 'แม่', category: 'บุคคล', example: '母は料理が上手です。', exampleReading: 'Haha wa ryouri ga jouzu desu.', exampleMeaning: 'แม่ทำอาหารเก่ง' },
          { char: '兄', on: 'KEI, KYOU', kun: 'ani', meaning: 'พี่ชาย', category: 'บุคคล', example: '兄が一人います。', exampleReading: 'Ani ga hitori imasu.', exampleMeaning: 'มีพี่ชายหนึ่งคน' },
          { char: '姉', on: 'SHI', kun: 'ane', meaning: 'พี่สาว', category: 'บุคคล', example: '姉は大学生です。', exampleReading: 'Ane wa daigakusei desu.', exampleMeaning: 'พี่สาวเป็นนักศึกษามหาวิทยาลัย' },
          { char: '弟', on: 'TEI, DAI', kun: 'otouto', meaning: 'น้องชาย', category: 'บุคคล', example: '弟とゲームをします。', exampleReading: 'Otouto to geemu o shimasu.', exampleMeaning: 'เล่นเกมกับน้องชาย' },
          { char: '妹', on: 'MAI', kun: 'imouto', meaning: 'น้องสาว', category: 'บุคคล', example: '妹は可愛いです。', exampleReading: 'Imouto wa kawaii desu.', exampleMeaning: 'น้องสาวน่ารัก' },
          { char: '天', on: 'TEN', kun: 'ama', meaning: 'ท้องฟ้า', category: 'ธรรมชาติ', example: '天気がいいです。', exampleReading: 'Tenki ga ii desu.', exampleMeaning: 'อากาศดี' },
          { char: '気', on: 'KI, KE', kun: '-', meaning: 'อากาศ', category: 'ธรรมชาติ', example: '元気ですか。', exampleReading: 'Genki desu ka.', exampleMeaning: 'สบายดีไหม' },
          { char: '雨', on: 'U', kun: 'ame', meaning: 'ฝน', category: 'ธรรมชาติ', example: '雨が降っています。', exampleReading: 'Ame ga futte imasu.', exampleMeaning: 'ฝนกำลังตก' },
          { char: '白', on: 'HAKU', kun: 'shiro(i)', meaning: 'สีขาว', category: 'สี', example: '白い猫がいます。', exampleReading: 'Shiroi neko ga imasu.', exampleMeaning: 'มีแมวสีขาว' },
          { char: '赤', on: 'SEKI', kun: 'aka(i)', meaning: 'สีแดง', category: 'สี', example: '顔が赤いです。', exampleReading: 'Kao ga akai desu.', exampleMeaning: 'หน้าแดง' },
          { char: '青', on: 'SEI', kun: 'ao(i)', meaning: 'สีน้ำเงิน', category: 'สี', example: '青い空がきれいです。', exampleReading: 'Aoi sora ga kirei desu.', exampleMeaning: 'ท้องฟ้าสีครามสวยงาม' },
          { char: '花', on: 'KA', kun: 'hana', meaning: 'ดอกไม้', category: 'ธรรมชาติ', example: '花を買いました。', exampleReading: 'Hana o kaimashita.', exampleMeaning: 'ซื้อดอกไม้แล้ว' },
          { char: '犬', on: 'KEN', kun: 'inu', meaning: 'สุนัข', category: 'สัตว์', example: '犬が好きです。', exampleReading: 'Inu ga suki desu.', exampleMeaning: 'ชอบสุนัข' },
          { char: '魚', on: 'GYO', kun: 'sakana', meaning: 'ปลา', category: 'สัตว์', example: '魚を食べます。', exampleReading: 'Sakana o tabemasu.', exampleMeaning: 'กินปลา' },
          { char: '手', on: 'SHU', kun: 'te', meaning: 'มือ', category: 'ร่างกาย', example: '手を洗ってください。', exampleReading: 'Te o aratte kudasai.', exampleMeaning: 'กรุณาล้างมือ' },
          { char: '足', on: 'SOKU', kun: 'ashi', meaning: 'เท้า', category: 'ร่างกาย', example: '足が速いです。', exampleReading: 'Ashi ga hayai desu.', exampleMeaning: 'วิ่งเร็ว (เท้าไว)' },
          { char: '目', on: 'MOKU', kun: 'me', meaning: 'ตา', category: 'ร่างกาย', example: '目が大きいです。', exampleReading: 'Me ga ookii desu.', exampleMeaning: 'ตาโต' },
          { char: '耳', on: 'JI', kun: 'mimi', meaning: 'หู', category: 'ร่างกาย', example: '耳が痛いです。', exampleReading: 'Mimi ga itai desu.', exampleMeaning: 'เจ็บหู' },
          { char: '買', on: 'BAI', kun: 'ka(u)', meaning: 'ซื้อ', category: 'การกระทำ', example: 'パンを買います。', exampleReading: 'Pan o kaimasu.', exampleMeaning: 'ซื้อขนมปัง' },
          { char: '売', on: 'BAI', kun: 'u(ru)', meaning: 'ขาย', category: 'การกระทำ', example: '車を売りました。', exampleReading: 'Kuruma o urimashita.', exampleMeaning: 'ขายรถแล้ว' },
          { char: '店', on: 'TEN', kun: 'mise', meaning: 'ร้านค้า', category: 'สถานที่', example: 'あの店はおいしいです。', exampleReading: 'Ano mise wa oishii desu.', exampleMeaning: 'ร้านนั้นอร่อย' },
          { char: '駅', on: 'EKI', kun: '-', meaning: 'สถานีรถไฟ', category: 'สถานที่', example: '駅まで歩きます。', exampleReading: 'Eki made arukimasu.', exampleMeaning: 'เดินไปจนถึงสถานี' },
          { char: '東', on: 'TOU', kun: 'higashi', meaning: 'ตะวันออก', category: 'ทิศทาง', example: '太陽は東から昇ります。', exampleReading: 'Taiyou wa higashi kara noborimasu.', exampleMeaning: 'ดวงอาทิตย์ขึ้นทางทิศตะวันออก' },
          { char: '西', on: 'SEI', kun: 'nishi', meaning: 'ตะวันตก', category: 'ทิศทาง', example: '西へ行きます。', exampleReading: 'Nishi e ikimasu.', exampleMeaning: 'ไปทางทิศตะวันตก' },
          { char: '南', on: 'NAN', kun: 'minami', meaning: 'ใต้', category: 'ทิศทาง', example: '南の島へ行きたいです。', exampleReading: 'Minami no shima e ikitai desu.', exampleMeaning: 'อยากไปเกาะทางใต้' },
          { char: '北', on: 'HOKU', kun: 'kita', meaning: 'เหนือ', category: 'ทิศทาง', example: '北風が冷たいです。', exampleReading: 'Kitakaze ga tsumetai desu.', exampleMeaning: 'ลมเหนือหนาวเย็น' },
          { char: '毎', on: 'MAI', kun: '-', meaning: 'ทุก', category: 'เวลา', example: '毎日コーヒーを飲みます。', exampleReading: 'Mainichi koohii o nomimasu.', exampleMeaning: 'ดื่มกาแฟทุกวัน' },
          { char: '何', on: 'KA', kun: 'nani', meaning: 'อะไร', category: 'คำถาม', example: 'これは何ですか。', exampleReading: 'Kore wa nan desu ka.', exampleMeaning: 'นี่คืออะไร' },
          { char: '会', on: 'KAI', kun: 'a(u)', meaning: 'พบ', category: 'การกระทำ', example: 'また会いましょう。', exampleReading: 'Mata aimashou.', exampleMeaning: 'แล้วพบกันใหม่' },
          { char: '社', on: 'SHA', kun: 'yashiro', meaning: 'บริษัท', category: 'สถานที่', example: '会社へ行きます。', exampleReading: 'Kaisha e ikimasu.', exampleMeaning: 'ไปบริษัท' },
          { char: '円', on: 'EN', kun: 'maru(i)', meaning: 'วงกลม, เยน', category: 'สิ่งของ', example: '百円です。', exampleReading: 'Hyaku en desu.', exampleMeaning: '100 เยน' },
          { char: '間', on: 'KAN', kun: 'aida', meaning: 'ระหว่าง', category: 'ตำแหน่ง', example: '時間があります。', exampleReading: 'Jikan ga arimasu.', exampleMeaning: 'มีเวลา' },
          { char: '二', on: 'NI', kun: 'futa(tsu)', meaning: 'สอง', category: 'ตัวเลข', example: '二つください。', exampleReading: 'Futatsu kudasai.', exampleMeaning: 'ขอสองอัน' },
          { char: '八', on: 'HACHI', kun: 'ya(ttsu)', meaning: 'แปด', category: 'ตัวเลข', example: '八時です。', exampleReading: 'Hachiji desu.', exampleMeaning: '8 โมงแล้ว' },
          { char: '力', on: 'RYOKU', kun: 'chikara', meaning: 'พลัง', category: 'คุณสมบัติ', example: '力が強いです。', exampleReading: 'Chikara ga tsuyoi desu.', exampleMeaning: 'มีพลังมาก' },
          { char: '十', on: 'JUU', kun: 'tou', meaning: 'สิบ', category: 'ตัวเลข', example: '十分待ちました。', exampleReading: 'Juppun machimashita.', exampleMeaning: 'รอ 10 นาทีแล้ว' },
          { char: '三', on: 'SAN', kun: 'mi(ttsu)', meaning: 'สาม', category: 'ตัวเลข', example: '三月三日です。', exampleReading: 'Sangatsu mikka desu.', exampleMeaning: 'วันที่ 3 เดือน 3' },
          { char: '千', on: 'SEN', kun: 'chi', meaning: 'พัน', category: 'ตัวเลข', example: '三千円です。', exampleReading: 'Sanzen en desu.', exampleMeaning: '3,000 เยน' },
          { char: '万', on: 'MAN', kun: '-', meaning: 'หมื่น', category: 'ตัวเลข', example: '一万円かかりました。', exampleReading: 'Ichiman en kakarimashita.', exampleMeaning: 'ใช้เงินไป 10,000 เยน' },
          { char: '四', on: 'SHI', kun: 'yon', meaning: 'สี่', category: 'ตัวเลข', example: '四人います。', exampleReading: 'Yonin imasu.', exampleMeaning: 'มี 4 คน' },
          { char: '五', on: 'GO', kun: 'itsu(tsu)', meaning: 'ห้า', category: 'ตัวเลข', example: '五月五日です。', exampleReading: 'Gogatsu itsuka desu.', exampleMeaning: 'วันที่ 5 เดือน 5' },
          { char: '六', on: 'ROKU', kun: 'mu(ttsu)', meaning: 'หก', category: 'ตัวเลข', example: '六時におきます。', exampleReading: 'Rokuji ni okimasu.', exampleMeaning: 'ตื่นนอน 6 โมง' },
          { char: '七', on: 'SHICHI', kun: 'nana(tsu)', meaning: 'เจ็ด', category: 'ตัวเลข', example: '七つあります。', exampleReading: 'Nanatsu arimasu.', exampleMeaning: 'มี 7 อัน' },
          { char: '九', on: 'KYUU', kun: 'kokono(tsu)', meaning: 'เก้า', category: 'ตัวเลข', example: '九時です。', exampleReading: 'Kuji desu.', exampleMeaning: '9 โมงแล้ว' },
          { char: '百', on: 'HYAKU', kun: '-', meaning: 'ร้อย', category: 'ตัวเลข', example: '三百人います。', exampleReading: 'Sanbyaku nin imasu.', exampleMeaning: 'มี 300 คน' },
          { char: '体', on: 'TAI', kun: 'karada', meaning: 'ร่างกาย', category: 'ร่างกาย', example: '体にいいです。', exampleReading: 'Karada ni ii desu.', exampleMeaning: 'ดีต่อร่างกาย' },
          { char: '作', on: 'SAKU', kun: 'tsuku(ru)', meaning: 'ทำ', category: 'การกระทำ', example: '料理を作ります。', exampleReading: 'Ryouri o tsukurimasu.', exampleMeaning: 'ทำอาหาร' },
          { char: '元', on: 'GEN', kun: 'moto', meaning: 'ต้นกำเนิด', category: 'ตำแหน่ง', example: '元気ですか。', exampleReading: 'Genki desu ka.', exampleMeaning: 'สบายดีไหม' },
          { char: '切', on: 'SETSU', kun: 'ki(ru)', meaning: 'ตัด', category: 'การกระทำ', example: '紙を切ってください。', exampleReading: 'Kami o kitte kudasai.', exampleMeaning: 'กรุณาตัดกระดาษ' },
          { char: '別', on: 'BETSU', kun: 'waka(reru)', meaning: 'แยก', category: 'สถานะ', example: '別々に払います。', exampleReading: 'Betsubetsu ni haraimasu.', exampleMeaning: 'จ่ายแยกกัน' },
          { char: '化', on: 'KA', kun: 'ba(keru)', meaning: 'เปลี่ยนแปลง', category: 'การกระทำ', example: '文化の日です。', exampleReading: 'Bunka no hi desu.', exampleMeaning: 'วันวัฒนธรรม' },
          { char: '世', on: 'SEI', kun: 'yo', meaning: 'โลก', category: 'เวลา', example: '世界中を旅行したい。', exampleReading: 'Sekaijuu o ryokou shitai.', exampleMeaning: 'อยากเที่ยวรอบโลก' },
          { char: '主', on: 'SHU', kun: 'nushi', meaning: 'เจ้าของ', category: 'บุคคล', example: 'ご主人はいらっしゃいますか。', exampleReading: 'Goshujin wa irasshaimasu ka.', exampleMeaning: 'สามีอยู่ไหมครับ/คะ' },
          { char: '京', on: 'KYOU', kun: '-', meaning: 'เมืองหลวง', category: 'สถานที่', example: '東京へ行きます。', exampleReading: 'Toukyou e ikimasu.', exampleMeaning: 'ไปโตเกียว' },
          { char: '以', on: 'I', kun: 'mo(tte)', meaning: 'ด้วย, มากกว่า', category: 'คำเชื่อม', example: '五分以上かかります。', exampleReading: 'Gofun ijou kakarimasu.', exampleMeaning: 'ใช้เวลามากกว่า 5 นาที' },
          { char: '方', on: 'HOU', kun: 'kata', meaning: 'ทิศทาง, วิธี', category: 'ทิศทาง', example: '読み方がわかりません。', exampleReading: 'Yomikata ga wakarimasen.', exampleMeaning: 'ไม่รู้วิธีอ่าน' },
          { char: '台', on: 'DAI', kun: '-', meaning: 'เครื่อง (ลักษณนาม)', category: 'ตัวนับ', example: '車が二台あります。', exampleReading: 'Kuruma ga nidai arimasu.', exampleMeaning: 'มีรถ 2 คัน' },
          { char: '思', on: 'SHI', kun: 'omo(u)', meaning: 'คิด', category: 'การกระทำ', example: 'そう思います。', exampleReading: 'Sou omoimasu.', exampleMeaning: 'คิดแบบนั้น' },
          { char: '持', on: 'JI', kun: 'mo(tsu)', meaning: 'ถือ', category: 'การกระทำ', example: 'お金を持っていますか。', exampleReading: 'Okane o motte imasu ka.', exampleMeaning: 'มีเงินไหม' },
          { char: '待', on: 'TAI', kun: 'ma(tsu)', meaning: 'รอ', category: 'การกระทำ', example: 'ちょっと待ってください。', exampleReading: 'Chotto matte kudasai.', exampleMeaning: 'กรุณารอสักครู่' },
          { char: '使', on: 'SHI', kun: 'tsuka(u)', meaning: 'ใช้', category: 'การกระทำ', example: 'パソコンを使います。', exampleReading: 'Pasokon o tsukaimasu.', exampleMeaning: 'ใช้คอมพิวเตอร์' },
          { char: '歩', on: 'HO', kun: 'aru(ku)', meaning: 'เดิน', category: 'การกระทำ', example: '歩いて帰ります。', exampleReading: 'Aruite kaerimasu.', exampleMeaning: 'เดินกลับบ้าน' },
          { char: '走', on: 'SOU', kun: 'hashi(ru)', meaning: 'วิ่ง', category: 'การกระทำ', example: '廊下を走らないでください。', exampleReading: 'Rouka o hashiranai de kudasai.', exampleMeaning: 'กรุณาอย่าวิ่งบนระเบียงทางเดิน' },
          { char: '起', on: 'KI', kun: 'o(kiru)', meaning: 'ตื่น', category: 'การกระทำ', example: '毎朝六時に起きます。', exampleReading: 'Maiasa rokuji ni okimasu.', exampleMeaning: 'ตื่นนอน 6 โมงทุกเช้า' },
          { char: '着', on: 'CHAKU', kun: 'ki(ru)', meaning: 'สวมใส่', category: 'การกระทำ', example: 'シャツを着ます。', exampleReading: 'Shatsu o kimasu.', exampleMeaning: 'ใส่เสื้อเชิ้ต' },
          { char: '知', on: 'CHI', kun: 'shi(ru)', meaning: 'รู้', category: 'การกระทำ', example: '知りませんでした。', exampleReading: 'Shirimasen deshita.', exampleMeaning: 'ไม่ทราบมาก่อน' },
          { char: '勉', on: 'BEN', kun: '-', meaning: 'พยายาม', category: 'การกระทำ', example: '毎日勉強します。', exampleReading: 'Mainichi benkyou shimasu.', exampleMeaning: 'เรียนทุกวัน' },
          { char: '強', on: 'KYOU', kun: 'tsuyo(i)', meaning: 'แข็งแรง', category: 'คุณสมบัติ', example: '風が強いです。', exampleReading: 'Kaze ga tsuyoi desu.', exampleMeaning: 'ลมแรง' },
          { char: '勝', on: 'SHOU', kun: 'ka(tsu)', meaning: 'ชนะ', category: 'การกระทำ', example: '試合に勝ちました。', exampleReading: 'Shiai ni kachimashita.', exampleMeaning: 'ชนะการแข่งขัน' },
          { char: '黒', on: 'KOKU', kun: 'kuro(i)', meaning: 'สีดำ', category: 'สี', example: '黒いペンです。', exampleReading: 'Kuroi pen desu.', exampleMeaning: 'ปากกาสีดำ' },
          { char: '場', on: 'JOU', kun: 'ba', meaning: 'สถานที่', category: 'สถานที่', example: '場所はどこですか。', exampleReading: 'Basho wa doko desu ka.', exampleMeaning: 'สถานที่คือที่ไหน' },
          { char: '地', on: 'CHI', kun: '-', meaning: 'พื้นดิน', category: 'สถานที่', example: '地下鉄で行きます。', exampleReading: 'Chikatetsu de ikimasu.', exampleMeaning: 'ไปโดยรถไฟใต้ดิน' },
          { char: '室', on: 'SHITSU', kun: 'muro', meaning: 'ห้อง', category: 'สถานที่', example: '教室にいます。', exampleReading: 'Kyoushitsu ni imasu.', exampleMeaning: 'อยู่ในห้องเรียน' },
          { char: '家', on: 'KA', kun: 'ie', meaning: 'บ้าน', category: 'สถานที่', example: '家に帰ります。', exampleReading: 'Ie ni kaerimasu.', exampleMeaning: 'กลับบ้าน' },
          { char: '朝', on: 'CHOU', kun: 'asa', meaning: 'เช้า', category: 'เวลา', example: '朝ごはんを食べます。', exampleReading: 'Asagohan o tabemasu.', exampleMeaning: 'กินข้าวเช้า' },
          { char: '昼', on: 'CHUU', kun: 'hiru', meaning: 'กลางวัน', category: 'เวลา', example: '昼休みです。', exampleReading: 'Hiruyasumi desu.', exampleMeaning: 'พักกลางวัน' },
          { char: '夜', on: 'YA', kun: 'yoru', meaning: 'กลางคืน', category: 'เวลา', example: '夜遅く寝ます。', exampleReading: 'Yoru osoku nemasu.', exampleMeaning: 'นอนดึก' },
          { char: '晩', on: 'BAN', kun: '-', meaning: 'ค่ำ', category: 'เวลา', example: '今晩空いていますか。', exampleReading: 'Konban aiteimasu ka.', exampleMeaning: 'เย็นนี้ว่างไหม' },
          { char: '週', on: 'SHUU', kun: '-', meaning: 'สัปดาห์', category: 'เวลา', example: '来週テストがあります。', exampleReading: 'Raishuu tesuto ga arimasu.', exampleMeaning: 'สัปดาห์หน้ามีสอบ' },
          { char: '春', on: 'SHUN', kun: 'haru', meaning: 'ฤดูใบไม้ผลิ', category: 'ฤดูกาล', example: '春になりました。', exampleReading: 'Haru ni narimashita.', exampleMeaning: 'เข้าสู่ฤดูใบไม้ผลิแล้ว' },
          { char: '夏', on: 'KA', kun: 'natsu', meaning: 'ฤดูร้อน', category: 'ฤดูกาล', example: '夏休みは海へ行きます。', exampleReading: 'Natsuyasumi wa umi e ikimasu.', exampleMeaning: 'วันหยุดฤดูร้อนจะไปทะเล' },
          { char: '秋', on: 'SHUU', kun: 'aki', meaning: 'ฤดูใบไม้ร่วง', category: 'ฤดูกาล', example: '秋は紅葉がきれいです。', exampleReading: 'Aki wa kouyou ga kirei desu.', exampleMeaning: 'ฤดูใบไม้ร่วงใบไม้เปลี่ยนสีสวยงาม' },
          { char: '冬', on: 'TOU', kun: 'fuyu', meaning: 'ฤดูหนาว', category: 'ฤดูกาล', example: '冬は寒いです。', exampleReading: 'Fuyu wa samui desu.', exampleMeaning: 'ฤดูหนาวอากาศหนาว' },
          { char: '物', on: 'BUTSU', kun: 'mono', meaning: 'สิ่งของ', category: 'สิ่งของ', example: '忘れ物をしました。', exampleReading: 'Wasuremono o shimashita.', exampleMeaning: 'ลืมของ' },
          { char: '品', on: 'HIN', kun: 'shina', meaning: 'สินค้า, คุณภาพ', category: 'สิ่งของ', example: '品物を見ます。', exampleReading: 'Shinamono o mimasu.', exampleMeaning: 'ดูสินค้า' },
          { char: '映', on: 'EI', kun: 'utsu(ru)', meaning: 'สะท้อน', category: 'การกระทำ', example: '映画を見に行きます。', exampleReading: 'Eiga o mini ikimasu.', exampleMeaning: 'ไปดูหนัง' },
          { char: '画', on: 'GA', kun: '-', meaning: 'ภาพ', category: 'ศิลปะ', example: '漫画が好きです。', exampleReading: 'Manga ga suki desu.', exampleMeaning: 'ชอบการ์ตูน' },
          { char: '洋', on: 'YOU', kun: '-', meaning: 'ตะวันตก', category: 'สถานที่', example: '洋服を買います。', exampleReading: 'Youfuku o kaimasu.', exampleMeaning: 'ซื้อเสื้อผ้า (แบบตะวันตก)' },
          { char: '海', on: 'KAI', kun: 'umi', meaning: 'ทะเล', category: 'ธรรมชาติ', example: '海で泳ぎます。', exampleReading: 'Umi de oyogimasu.', exampleMeaning: 'ว่ายน้ำในทะเล' },
          { char: '牛', on: 'GYUU', kun: 'ushi', meaning: 'วัว', category: 'สัตว์', example: '牛乳を飲みます。', exampleReading: 'Gyuunyuu o nomimasu.', exampleMeaning: 'ดื่มนมวัว' },
          { char: '鳥', on: 'CHOU', kun: 'tori', meaning: 'นก', category: 'สัตว์', example: '鳥が飛んでいます。', exampleReading: 'Tori ga tonde imasu.', exampleMeaning: 'นกกำลังบิน' },
          { char: '肉', on: 'NIKU', kun: '-', meaning: 'เนื้อ', category: 'อาหาร', example: '肉を食べません。', exampleReading: 'Niku o tabemasen.', exampleMeaning: 'ไม่กินเนื้อ' },
          { char: '野', on: 'YA', kun: 'no', meaning: 'ทุ่ง', category: 'ธรรมชาติ', example: '野球をします。', exampleReading: 'Yakyuu o shimasu.', exampleMeaning: 'เล่นเบสบอล' },
          { char: '菜', on: 'SAI', kun: 'na', meaning: 'ผัก', category: 'อาหาร', example: '野菜を食べましょう。', exampleReading: 'Yasai o tabemashou.', exampleMeaning: 'กินผักกันเถอะ' },
          { char: '茶', on: 'CHA', kun: '-', meaning: 'ชา', category: 'เครื่องดื่ม', example: 'お茶をください。', exampleReading: 'Ocha o kudasai.', exampleMeaning: 'ขอน้ำชาหน่อย' },
          { char: '業', on: 'GYOU', kun: 'waza', meaning: 'อาชีพ', category: 'งาน', example: '授業が始まります。', exampleReading: 'Jugyou ga hajimarimasu.', exampleMeaning: 'ชั่วโมงเรียนเริ่มแล้ว' },
          { char: '終', on: 'SHUU', kun: 'o(waru)', meaning: 'จบ', category: 'การกระทำ', example: '仕事が終わりました。', exampleReading: 'Shigoto ga owarimashita.', exampleMeaning: 'งานเสร็จแล้ว' },
          { char: '習', on: 'SHUU', kun: 'nara(u)', meaning: 'เรียนรู้', category: 'การกระทำ', example: 'ピアノを習っています。', exampleReading: 'Piano o naratte imasu.', exampleMeaning: 'กำลังเรียนเปียโน' },
          { char: '質', on: 'SHITSU', kun: '-', meaning: 'คุณภาพ', category: 'คุณสมบัติ', example: '質問があります。', exampleReading: 'Shitsumon ga arimasu.', exampleMeaning: 'มีคำถาม' },
          { char: '問', on: 'MON', kun: 'to(u)', meaning: 'ถาม', category: 'การกระทำ', example: '問題を解きます。', exampleReading: 'Mondai o tokimasu.', exampleMeaning: 'แก้โจทย์ปัญหา' },
          { char: '答', on: 'TOU', kun: 'kota(eru)', meaning: 'ตอบ', category: 'การกระทำ', example: '答えを書いてください。', exampleReading: 'Kotae o kaite kudasai.', exampleMeaning: 'กรุณาเขียนคำตอบ' },
          { char: '開', on: 'KAI', kun: 'a(ku)', meaning: 'เปิด', category: 'การกระทำ', example: 'ドアを開けます。', exampleReading: 'Doa o akemasu.', exampleMeaning: 'เปิดประตู' },
          { char: '閉', on: 'HEI', kun: 'shi(meru)', meaning: 'ปิด', category: 'การกระทำ', example: '窓を閉めてください。', exampleReading: 'Mado o shimete kudasai.', exampleMeaning: 'กรุณาปิดหน้าต่าง' },
          { char: '写', on: 'SHA', kun: 'utsu(su)', meaning: 'ถ่าย', category: 'การกระทำ', example: '写真を撮ります。', exampleReading: 'Shashin o torimasu.', exampleMeaning: 'ถ่ายรูป' },
          { char: '真', on: 'SHIN', kun: 'ma', meaning: 'ความจริง', category: 'คุณสมบัติ', example: '真ん中に置いてください。', exampleReading: 'Mannaka ni oite kudasai.', exampleMeaning: 'กรุณาวางไว้ตรงกลาง' },
          { char: '借', on: 'SHAKU', kun: 'ka(riru)', meaning: 'ยืม', category: 'การกระทำ', example: '本を借りました。', exampleReading: 'Hon o karimashita.', exampleMeaning: 'ยืมหนังสือแล้ว' },
          { char: '貸', on: 'TAI', kun: 'ka(su)', meaning: 'ให้ยืม', category: 'การกระทำ', example: 'ペンを貸してください。', exampleReading: 'Pen o kashite kudasai.', exampleMeaning: 'ขอยืมปากกาหน่อย' },
          { char: '宿', on: 'SHUKU', kun: 'yado', meaning: 'ที่พัก', category: 'สถานที่', example: '宿題をします。', exampleReading: 'Shukudai o shimasu.', exampleMeaning: 'ทำการบ้าน' },
          { char: '題', on: 'DAI', kun: '-', meaning: 'หัวข้อ', category: 'เรื่องราว', example: '話題を変えましょう。', exampleReading: 'Wadai o kaemashou.', exampleMeaning: 'เปลี่ยนเรื่องคุยกันเถอะ' },
          { char: '旅', on: 'RYO', kun: 'tabi', meaning: 'การเดินทาง', category: 'การกระทำ', example: '旅行が好きです。', exampleReading: 'Ryokou ga suki desu.', exampleMeaning: 'ชอบการท่องเที่ยว' },
          { char: '族', on: 'ZOKU', kun: '-', meaning: 'ครอบครัว', category: 'บุคคล', example: '家族は元気です。', exampleReading: 'Kazoku wa genki desu.', exampleMeaning: 'ครอบครัวสบายดี' },
          { char: '親', on: 'SHIN', kun: 'oya', meaning: 'พ่อแม่', category: 'บุคคล', example: '親切な人です。', exampleReading: 'Shinsetsu na hito desu.', exampleMeaning: 'เป็นคนใจดี' },
          { char: '医', on: 'I', kun: '-', meaning: 'หมอ', category: 'อาชีพ', example: '医者になりたいです。', exampleReading: 'Isha ni naritai desu.', exampleMeaning: 'อยากเป็นหมอ' },
          { char: '者', on: 'SHA', kun: 'mono', meaning: 'ผู้', category: 'บุคคล', example: '若者が多いです。', exampleReading: 'Wakamono ga ooi desu.', exampleMeaning: 'วัยรุ่นเยอะ' },
          { char: '病', on: 'BYOU', kun: 'ya(mu)', meaning: 'ป่วย', category: 'สุขภาพ', example: '病気になりました。', exampleReading: 'Byouki ni narimashita.', exampleMeaning: 'ป่วยซะแล้ว' },
          { char: '院', on: 'IN', kun: '-', meaning: 'สถาบัน', category: 'สถานที่', example: '病院へ行きます。', exampleReading: 'Byouin e ikimasu.', exampleMeaning: 'ไปโรงพยาบาล' },
          { char: '銀', on: 'GIN', kun: '-', meaning: 'เงิน', category: 'โลหะ', example: '銀行はどこですか。', exampleReading: 'Ginkou wa doko desu ka.', exampleMeaning: 'ธนาคารอยู่ที่ไหน' },
          { char: '有', on: 'YUU', kun: 'a(ru)', meaning: 'มี', category: 'การกระทำ', example: '有名な人です。', exampleReading: 'Yuumei na hito desu.', exampleMeaning: 'เป็นคนมีชื่อเสียง' },
          { char: '無', on: 'MU', kun: 'na(i)', meaning: 'ไม่มี', category: 'สถานะ', example: '無理しないでください。', exampleReading: 'Muri shinai de kudasai.', exampleMeaning: 'อย่าฝืนเลย' },
          { char: '教', on: 'KYOU', kun: 'oshi(eru)', meaning: 'สอน', category: 'การกระทำ', example: '日本語を教えています。', exampleReading: 'Nihongo o oshiete imasu.', exampleMeaning: 'กำลังสอนภาษาญี่ปุ่น' },
          { char: '計', on: 'KEI', kun: 'haka(ru)', meaning: 'คำนวณ', category: 'การกระทำ', example: '時計を見てください。', exampleReading: 'Tokei o mite kudasai.', exampleMeaning: 'กรุณาดูนาฬิกา' },
          { char: '始', on: 'SHI', kun: 'haji(meru)', meaning: 'เริ่ม', category: 'การกระทำ', example: '勉強を始めます。', exampleReading: 'Benkyou ohajimemasu.', exampleMeaning: 'เริ่มเรียน' },
          { char: '雪', on: 'SETSU', kun: 'yuki', meaning: 'หิมะ', category: 'ธรรมชาติ', example: '雪が降っています。', exampleReading: 'Yuki ga futte imasu.', exampleMeaning: 'หิมะกำลังตก' },
          { char: '転', on: 'TEN', kun: 'koro(bu)', meaning: 'หมุน', category: 'การกระทำ', example: '自転車に乗ります。', exampleReading: 'Jitensha ni norimasu.', exampleMeaning: 'ขี่จักรยาน' },
          { char: '運', on: 'UN', kun: 'hako(bu)', meaning: 'ขนส่ง', category: 'การกระทำ', example: '運動します。', exampleReading: 'Undou shimasu.', exampleMeaning: 'ออกกำลังกาย' },
          { char: '動', on: 'DOU', kun: 'ugo(ku)', meaning: 'เคลื่อนไหว', category: 'การกระทำ', example: '動物園に行きました。', exampleReading: 'Doubutsuen ni ikimashita.', exampleMeaning: 'ไปสวนสัตว์มา' }
        ];

        // --- Main App Component ---
        function App() {
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedCategory, setSelectedCategory] = useState('All');
          const [viewMode, setViewMode] = useState('list'); // 'list', 'flashcard', 'quiz', 'quiz-setup'
          const [currentCardIndex, setCurrentCardIndex] = useState(0);
          const [isFlipped, setIsFlipped] = useState(false);

          // Quiz State
          const [quizConfig, setQuizConfig] = useState({ category: 'All', questionCount: 10 });
          const [quizQuestions, setQuizQuestions] = useState([]);
          const [currentQuizIndex, setCurrentQuizIndex] = useState(0);
          const [score, setScore] = useState(0);
          const [showScore, setShowScore] = useState(false);
          const [selectedAnswer, setSelectedAnswer] = useState(null); 
          const [answerStatus, setAnswerStatus] = useState(null); 
          
          // AI Chat State
          const [aiChatOpen, setAiChatOpen] = useState(false);
          const [aiQuery, setAiQuery] = useState('');
          const [aiResponse, setAiResponse] = useState('');
          const [aiLoading, setAiLoading] = useState(false);
          const chatEndRef = useRef(null);

          // Extract unique categories
          const categories = useMemo(() => {
            const cats = new Set(rawData.map(item => item.category));
            return ['All', ...Array.from(cats).sort()];
          }, []);

          // Filter data (List/Flashcard view)
          const filteredData = useMemo(() => {
            return rawData.filter(item => {
              const matchesSearch = 
                item.char.includes(searchTerm) || 
                item.meaning.includes(searchTerm) ||
                item.on.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.kun.toLowerCase().includes(searchTerm.toLowerCase());
              
              const matchesCategory = selectedCategory === 'All' || item.category === selectedCategory;

              return matchesSearch && matchesCategory;
            });
          }, [searchTerm, selectedCategory]);

          // Calculate available questions for setup
          const availableQuestionsCount = useMemo(() => {
              if (quizConfig.category === 'All') return rawData.length;
              return rawData.filter(item => item.category === quizConfig.category).length;
          }, [quizConfig.category]);

          // Handlers for Flashcard Mode
          const nextCard = () => {
            setIsFlipped(false);
            setCurrentCardIndex(prev => (prev + 1) % filteredData.length);
          };

          const prevCard = () => {
            setIsFlipped(false);
            setCurrentCardIndex(prev => (prev - 1 + filteredData.length) % filteredData.length);
          };

          const flipCard = () => {
            setIsFlipped(!isFlipped);
          };

          // Quiz Logic
          const enterQuizSetup = () => {
              setViewMode('quiz-setup');
              setQuizConfig({ category: 'All', questionCount: 10 });
          };

          const startQuiz = () => {
            // Pool selection based on Quiz Config
            let pool = rawData;
            if (quizConfig.category !== 'All') {
                pool = rawData.filter(item => item.category === quizConfig.category);
            }
            
            if (pool.length === 0) return; // Should not happen with UI logic

            const shuffled = [...pool].sort(() => 0.5 - Math.random());
            
            // Determine actual count
            let limit = quizConfig.questionCount;
            if (limit === 'Max') limit = pool.length;
            else limit = Math.min(parseInt(limit), pool.length);
            
            const selected = shuffled.slice(0, Math.max(1, limit));

            const questions = selected.map(q => {
              // Create distractors (from ALL data to keep it challenging)
              const distractors = rawData
                .filter(item => item.char !== q.char)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3)
                .map(item => item.meaning);
              
              const options = [...distractors, q.meaning].sort(() => 0.5 - Math.random());
              
              return {
                ...q,
                options
              };
            });

            setQuizQuestions(questions);
            setCurrentQuizIndex(0);
            setScore(0);
            setShowScore(false);
            setSelectedAnswer(null);
            setAnswerStatus(null);
            setViewMode('quiz');
            // Reset AI state
            setAiChatOpen(false);
            setAiQuery('');
            setAiResponse('');
          };

          const handleAnswerClick = (option) => {
            if (selectedAnswer) return; 

            setSelectedAnswer(option);
            const isCorrect = option === quizQuestions[currentQuizIndex].meaning;
            
            if (isCorrect) {
              setScore(score + 1);
              setAnswerStatus('correct');
            } else {
              setAnswerStatus('incorrect');
            }
          };

          const nextQuizQuestion = () => {
            const nextQuestion = currentQuizIndex + 1;
            if (nextQuestion < quizQuestions.length) {
              setCurrentQuizIndex(nextQuestion);
              setSelectedAnswer(null);
              setAnswerStatus(null);
              // Reset AI state for new question
              setAiChatOpen(false);
              setAiQuery('');
              setAiResponse('');
            } else {
              setShowScore(true);
            }
          };
          
          // AI Chat Logic
          const handleAskAI = async () => {
              if (!aiQuery.trim()) return;
              setAiLoading(true);
              setAiResponse(''); // Clear previous response
              
              const currentKanji = quizQuestions[currentQuizIndex];
              const prompt = `คุณคือครูสอนภาษาญี่ปุ่นใจดีและมีความรู้ลึกซึ้ง ผู้เรียนกำลังถามเกี่ยวกับคันจิ: ${currentKanji.char} (ความหมาย: ${currentKanji.meaning}, อ่านแบบ On: ${currentKanji.on} / Kun: ${currentKanji.kun})
              
              บริบท: ผู้เรียนเพิ่งทำแบบทดสอบและต้องการคำอธิบายเพิ่มเติม
              ประโยคตัวอย่างที่มีในระบบ: ${currentKanji.example} (${currentKanji.exampleMeaning})
              
              คำถามของผู้เรียน: ${aiQuery}
              
              กรุณาตอบเป็นภาษาไทย อธิบายให้เข้าใจง่าย สั้นกระชับ และเป็นกันเอง (ใช้ Markdown ได้)`;

              try {
                  const apiKey = ""; // The environment provides the key automatically
                  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                      method: 'POST',
                      headers: { 'Content-Type': 'application/json' },
                      body: JSON.stringify({
                          contents: [{ parts: [{ text: prompt }] }]
                      })
                  });
                  
                  const data = await response.json();
                  if (data.error) {
                      throw new Error(data.error.message);
                  }
                  
                  const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "ขออภัย ครู AI ไม่สามารถตอบคำถามได้ในขณะนี้";
                  setAiResponse(text);
              } catch (error) {
                  console.error("AI Error:", error);
                  setAiResponse("ขออภัย เกิดข้อผิดพลาดในการเชื่อมต่อกับครู AI (กรุณาลองใหม่)");
              } finally {
                  setAiLoading(false);
              }
          };

          // Reset index when filter changes
          useMemo(() => {
            setCurrentCardIndex(0);
            setIsFlipped(false);
          }, [filteredData.length]);

          // Scroll to bottom of chat when response updates
          useEffect(() => {
             if (chatEndRef.current) {
                 chatEndRef.current.scrollIntoView({ behavior: 'smooth' });
             }
          }, [aiResponse, aiLoading, aiChatOpen]);

          return (
            <div className="min-h-screen bg-slate-50 text-slate-800 font-sans pb-10">
              {/* Header */}
              <header className="bg-white border-b border-slate-200 sticky top-0 z-10 shadow-sm">
                <div className="max-w-5xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
                  <div className="flex items-center gap-3">
                    <div className="bg-red-500 text-white p-2 rounded-lg">
                      <BookOpen size={24} />
                    </div>
                    <h1 className="text-2xl font-bold tracking-tight text-slate-900">JLPT Kanji Dictionary</h1>
                  </div>
                  
                  <div className="flex bg-slate-100 p-1 rounded-lg overflow-x-auto">
                    <button 
                      onClick={() => setViewMode('list')}
                      className={`flex items-center gap-2 px-4 py-2 rounded-md transition-all whitespace-nowrap ${viewMode === 'list' ? 'bg-white shadow-sm text-blue-600 font-medium' : 'text-slate-500 hover:text-slate-700'}`}
                    >
                      <LayoutList size={18} /> รายการ
                    </button>
                    <button 
                      onClick={() => setViewMode('flashcard')}
                      className={`flex items-center gap-2 px-4 py-2 rounded-md transition-all whitespace-nowrap ${viewMode === 'flashcard' ? 'bg-white shadow-sm text-blue-600 font-medium' : 'text-slate-500 hover:text-slate-700'}`}
                    >
                      <RefreshCw size={18} /> การ์ดคำศัพท์
                    </button>
                    <button 
                      onClick={enterQuizSetup}
                      className={`flex items-center gap-2 px-4 py-2 rounded-md transition-all whitespace-nowrap ${(viewMode === 'quiz' || viewMode === 'quiz-setup') ? 'bg-white shadow-sm text-blue-600 font-medium' : 'text-slate-500 hover:text-slate-700'}`}
                    >
                      <GraduationCap size={18} /> แบบทดสอบ
                    </button>
                  </div>
                </div>
              </header>

              <main className="max-w-5xl mx-auto px-4 mt-6">
                
                {/* Controls: Search & Category - Show only in List/Flashcard mode */}
                {(viewMode === 'list' || viewMode === 'flashcard') && (
                  <React.Fragment>
                    <div className="flex flex-col md:flex-row gap-4 mb-8">
                      <div className="relative flex-1">
                        <div className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
                            <Search size={20} />
                        </div>
                        <input 
                          type="text" 
                          placeholder="ค้นหา (คันจิ, ความหมาย, เสียงอ่าน)..." 
                          className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition-all"
                          value={searchTerm}
                          onChange={(e) => setSearchTerm(e.target.value)}
                        />
                      </div>
                      
                      <div className="flex-none">
                        <select 
                          className="w-full md:w-48 p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white shadow-sm cursor-pointer"
                          value={selectedCategory}
                          onChange={(e) => setSelectedCategory(e.target.value)}
                        >
                          {categories.map(cat => (
                            <option key={cat} value={cat}>
                              {cat === 'All' ? 'ทั้งหมด' : cat}
                            </option>
                          ))}
                        </select>
                      </div>
                    </div>

                    {/* Categories Quick Tags (Desktop) */}
                    <div className="hidden md:flex flex-wrap gap-2 mb-6">
                      {categories.slice(0, 12).map(cat => (
                        <button
                          key={cat}
                          onClick={() => setSelectedCategory(cat)}
                          className={`px-3 py-1 rounded-full text-xs font-medium border transition-colors ${selectedCategory === cat ? 'bg-blue-100 text-blue-700 border-blue-200' : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-50'}`}
                        >
                          {cat}
                        </button>
                      ))}
                    </div>
                  </React.Fragment>
                )}

                {/* Content Area */}
                {viewMode === 'quiz-setup' ? (
                  /* Quiz Setup View */
                   <div className="max-w-lg mx-auto bg-white rounded-3xl shadow-lg border border-slate-200 p-8 animate-fade-in">
                       <div className="flex items-center gap-3 mb-6">
                           <div className="bg-blue-100 text-blue-600 p-3 rounded-full">
                               <Settings size={28} />
                           </div>
                           <h2 className="text-2xl font-bold text-slate-800">ตั้งค่าแบบทดสอบ</h2>
                       </div>
                       
                       <div className="space-y-6">
                           {/* Category Selection */}
                           <div>
                               <label className="block text-sm font-semibold text-slate-700 mb-2">เลือกหมวดหมู่</label>
                               <select 
                                  className="w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-slate-50"
                                  value={quizConfig.category}
                                  onChange={(e) => setQuizConfig({...quizConfig, category: e.target.value})}
                               >
                                  {categories.map(cat => (
                                    <option key={cat} value={cat}>
                                      {cat === 'All' ? 'ทั้งหมด' : cat}
                                    </option>
                                  ))}
                               </select>
                           </div>

                           {/* Count Selection */}
                           <div>
                               <label className="block text-sm font-semibold text-slate-700 mb-2">จำนวนข้อสอบ</label>
                               <div className="grid grid-cols-4 gap-2">
                                   {[5, 10, 20, 'Max'].map(count => (
                                       <button
                                           key={count}
                                           onClick={() => setQuizConfig({...quizConfig, questionCount: count})}
                                           className={`py-2 rounded-lg font-medium border transition-all ${
                                               quizConfig.questionCount === count 
                                               ? 'bg-blue-600 text-white border-blue-600 shadow-md' 
                                               : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-50'
                                           }`}
                                       >
                                           {count === 'Max' ? 'ทั้งหมด' : count}
                                       </button>
                                   ))}
                               </div>
                           </div>

                           {/* Info Summary */}
                           <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 text-sm text-slate-600 flex justify-between">
                               <span>คำศัพท์ในหมวดนี้:</span>
                               <span className="font-bold">{availableQuestionsCount} คำ</span>
                           </div>

                           <button 
                               onClick={startQuiz}
                               disabled={availableQuestionsCount === 0}
                               className="w-full py-4 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 transition-all shadow-md active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                           >
                               เริ่มทำแบบทดสอบ
                           </button>
                       </div>
                   </div>
                ) : viewMode === 'quiz' ? (
                  /* Quiz View */
                  <div className="max-w-xl mx-auto">
                    {showScore ? (
                      <div className="bg-white rounded-3xl shadow-lg border border-slate-200 p-8 text-center animate-fade-in">
                        <div className="inline-flex items-center justify-center w-24 h-24 bg-blue-50 rounded-full mb-6 text-blue-600">
                           <GraduationCap size={48} />
                        </div>
                        <h2 className="text-3xl font-bold text-slate-800 mb-2">สรุปผลคะแนน</h2>
                        <div className="text-5xl font-black text-blue-600 mb-4">
                          {score} / {quizQuestions.length}
                        </div>
                        <p className="text-slate-500 mb-8">
                          {score === quizQuestions.length ? 'ยอดเยี่ยม! คุณทำได้คะแนนเต็ม' : 
                           score >= quizQuestions.length / 2 ? 'ทำได้ดีมาก! พยายามต่อไปนะ' : 'ฝึกฝนอีกนิด เก่งขึ้นแน่นอน'}
                        </p>
                        <div className="flex flex-col gap-3">
                            <button 
                              onClick={enterQuizSetup}
                              className="flex items-center justify-center gap-2 w-full py-4 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 transition-all shadow-md active:scale-95"
                            >
                              <Settings size={20} /> ตั้งค่าการสอบใหม่
                            </button>
                            <button 
                              onClick={startQuiz}
                              className="flex items-center justify-center gap-2 w-full py-4 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-50 transition-all active:scale-95"
                            >
                              <RotateCcw size={20} /> สอบซ้ำ (การตั้งค่าเดิม)
                            </button>
                        </div>
                      </div>
                    ) : (
                      <div className="bg-white rounded-3xl shadow-lg border border-slate-200 overflow-hidden">
                        {/* Progress Bar */}
                        <div className="w-full bg-slate-100 h-2">
                          <div 
                            className="bg-blue-500 h-2 transition-all duration-300"
                            style={{ width: `${((currentQuizIndex + 1) / quizQuestions.length) * 100}%` }}
                          ></div>
                        </div>

                        <div className="p-8">
                          <div className="flex justify-between items-center mb-6">
                            <span className="text-sm font-semibold text-slate-400 uppercase tracking-wide">
                              คำถามที่ {currentQuizIndex + 1} / {quizQuestions.length}
                            </span>
                            <span className="bg-slate-100 text-slate-600 px-3 py-1 rounded-full text-xs font-bold">
                              {quizQuestions[currentQuizIndex].category}
                            </span>
                          </div>

                          <div className="text-center mb-10">
                            <div className="inline-block text-8xl font-serif text-slate-800 mb-2 p-6 bg-slate-50 rounded-2xl border border-slate-100 min-w-[160px]">
                              {quizQuestions[currentQuizIndex].char}
                            </div>
                            <p className="text-slate-500 text-sm">เลือกความหมายที่ถูกต้อง</p>
                          </div>

                          <div className="grid grid-cols-1 gap-3">
                            {quizQuestions[currentQuizIndex].options.map((option, idx) => {
                              const isCorrectAnswer = option === quizQuestions[currentQuizIndex].meaning;
                              const isSelected = selectedAnswer === option;
                              
                              let btnClass = "p-4 rounded-xl border-2 text-left font-medium transition-all flex justify-between items-center ";
                              
                              if (selectedAnswer) {
                                if (isCorrectAnswer) {
                                  btnClass += "bg-green-50 border-green-500 text-green-700";
                                } else if (isSelected) {
                                  btnClass += "bg-red-50 border-red-500 text-red-700";
                                } else {
                                  btnClass += "bg-white border-slate-100 text-slate-400 opacity-50";
                                }
                              } else {
                                btnClass += "bg-white border-slate-200 text-slate-700 hover:border-blue-400 hover:bg-blue-50";
                              }

                              return (
                                <button 
                                  key={idx}
                                  onClick={() => handleAnswerClick(option)}
                                  disabled={!!selectedAnswer}
                                  className={btnClass}
                                >
                                  <span>{option}</span>
                                  {selectedAnswer && isCorrectAnswer && <CheckCircle size={20} className="text-green-600" />}
                                  {selectedAnswer && isSelected && !isCorrectAnswer && <XCircle size={20} className="text-red-500" />}
                                </button>
                              );
                            })}
                          </div>

                          {selectedAnswer && (
                            <div className="mt-8 pt-6 border-t border-slate-100 animate-slide-up">
                              <div className="flex flex-col gap-4">
                                <div className="text-sm">
                                  {answerStatus === 'correct' ? (
                                    <span className="text-green-600 font-bold flex items-center gap-2 mb-2"><CheckCircle size={16}/> ถูกต้อง!</span>
                                  ) : (
                                    <span className="text-red-500 font-bold flex items-center gap-2 mb-2"><XCircle size={16}/> ผิด!</span>
                                  )}
                                  
                                  {/* Answer Detail Box */}
                                  <div className="bg-slate-50 border border-slate-200 rounded-xl p-4 mt-2">
                                      <div className="flex items-center gap-3 mb-3">
                                          <div className="text-3xl font-serif text-slate-800">{quizQuestions[currentQuizIndex].char}</div>
                                          <div className="text-lg font-bold text-slate-800">{quizQuestions[currentQuizIndex].meaning}</div>
                                      </div>
                                      
                                      <div className="grid grid-cols-2 gap-4 mb-4">
                                          <div className="bg-white p-2 rounded border border-slate-100">
                                              <span className="block text-[10px] font-bold text-red-400 uppercase">On-yomi</span>
                                              <span className="font-mono text-slate-600">{quizQuestions[currentQuizIndex].on || '-'}</span>
                                          </div>
                                          <div className="bg-white p-2 rounded border border-slate-100">
                                              <span className="block text-[10px] font-bold text-blue-400 uppercase">Kun-yomi</span>
                                              <span className="font-mono text-slate-600">{quizQuestions[currentQuizIndex].kun || '-'}</span>
                                          </div>
                                      </div>

                                      {/* Example Sentence Section in Quiz */}
                                      {quizQuestions[currentQuizIndex].example && (
                                        <div className="bg-yellow-50 border border-yellow-100 rounded-lg p-3 mb-3">
                                            <div className="flex items-center gap-2 mb-1 text-yellow-600">
                                                <Lightbulb size={16} />
                                                <span className="text-xs font-bold uppercase">ตัวอย่างประโยค</span>
                                            </div>
                                            <div className="text-sm text-slate-800 mb-1 font-medium">{quizQuestions[currentQuizIndex].example}</div>
                                            <div className="text-xs text-slate-500 italic mb-1">{quizQuestions[currentQuizIndex].exampleReading}</div>
                                            <div className="text-xs text-slate-600">{quizQuestions[currentQuizIndex].exampleMeaning}</div>
                                        </div>
                                      )}

                                      {/* AI Chat Button/Section */}
                                      {!aiChatOpen ? (
                                        <button 
                                          onClick={() => setAiChatOpen(true)}
                                          className="w-full flex items-center justify-center gap-2 py-2 bg-indigo-50 text-indigo-700 rounded-lg font-bold text-sm border border-indigo-100 hover:bg-indigo-100 transition-colors"
                                        >
                                          <Sparkles size={16} /> ถามครู AI เกี่ยวกับคำนี้
                                        </button>
                                      ) : (
                                        <div className="bg-white border border-indigo-100 rounded-lg p-3 shadow-sm animate-fade-in">
                                            <div className="flex justify-between items-center mb-2">
                                                <span className="text-xs font-bold text-indigo-600 flex items-center gap-1">
                                                    <Sparkles size={12} /> ครู AI (Sensei)
                                                </span>
                                                <button onClick={() => setAiChatOpen(false)} className="text-slate-400 hover:text-slate-600">
                                                    <XCircle size={16} />
                                                </button>
                                            </div>
                                            
                                            <div className="mb-3 max-h-40 overflow-y-auto scrollbar-thin pr-1 text-sm">
                                                {aiResponse ? (
                                                    <div className="ai-response bg-slate-50 p-2 rounded text-slate-700 text-sm leading-relaxed" dangerouslySetInnerHTML={{ __html: marked.parse(aiResponse) }}></div>
                                                ) : aiLoading ? (
                                                    <div className="text-center py-4 text-slate-400 text-xs animate-pulse">กำลังคิดคำตอบ...</div>
                                                ) : (
                                                    <div className="text-center py-4 text-slate-400 text-xs">พิมพ์คำถามเกี่ยวกับ "{quizQuestions[currentQuizIndex].char}" ได้เลยครับ</div>
                                                )}
                                                <div ref={chatEndRef}></div>
                                            </div>

                                            <div className="flex gap-2">
                                                <input 
                                                    type="text" 
                                                    value={aiQuery}
                                                    onChange={(e) => setAiQuery(e.target.value)}
                                                    onKeyDown={(e) => e.key === 'Enter' && handleAskAI()}
                                                    placeholder="เช่น: คำนี้ใช้ยังไง, ขอตัวอย่างเพิ่ม..." 
                                                    className="flex-1 text-sm border border-slate-200 rounded-md px-2 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500"
                                                />
                                                <button 
                                                    onClick={handleAskAI}
                                                    disabled={aiLoading || !aiQuery.trim()}
                                                    className="bg-indigo-600 text-white p-1.5 rounded-md hover:bg-indigo-700 disabled:opacity-50"
                                                >
                                                    <Send size={16} />
                                                </button>
                                            </div>
                                        </div>
                                      )}
                                  </div>
                                </div>
                                
                                <button 
                                  onClick={nextQuizQuestion}
                                  className="self-end px-6 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm"
                                >
                                  {currentQuizIndex < quizQuestions.length - 1 ? 'ข้อถัดไป' : 'ดูผลลัพธ์'}
                                </button>
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    )}
                  </div>
                ) : filteredData.length === 0 ? (
                  <div className="text-center py-20 bg-white rounded-2xl border border-slate-100 shadow-sm">
                    <div className="text-6xl mb-4">🔍</div>
                    <p className="text-xl text-slate-500">ไม่พบคำศัพท์ที่คุณค้นหา</p>
                    <button 
                      onClick={() => {setSearchTerm(''); setSelectedCategory('All');}}
                      className="mt-4 text-blue-500 hover:underline"
                    >
                      ล้างการค้นหา
                    </button>
                  </div>
                ) : viewMode === 'list' ? (
                  /* List View */
                  <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    {filteredData.map((item, idx) => (
                      <div key={idx} className="bg-white rounded-xl p-5 border border-slate-100 shadow-sm hover:shadow-md transition-shadow group">
                        <div className="flex justify-between items-start mb-3">
                          <span className="text-xs font-semibold px-2 py-1 bg-slate-100 text-slate-500 rounded-md">
                            {item.category}
                          </span>
                        </div>
                        
                        <div className="flex gap-4">
                          <div className="w-20 h-20 bg-blue-50 rounded-lg flex items-center justify-center text-5xl font-serif text-slate-800 shrink-0 group-hover:text-blue-600 transition-colors">
                            {item.char}
                          </div>
                          <div className="flex-1">
                            <h3 className="text-lg font-bold text-slate-800 mb-1">{item.meaning}</h3>
                            <div className="space-y-1 text-sm">
                              <div className="flex items-baseline gap-2">
                                <span className="text-[10px] uppercase font-bold text-red-400 w-8">On</span>
                                <span className="text-slate-600 font-mono">{item.on}</span>
                              </div>
                              <div className="flex items-baseline gap-2">
                                <span className="text-[10px] uppercase font-bold text-blue-400 w-8">Kun</span>
                                <span className="text-slate-600 font-mono">{item.kun}</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                ) : (
                  /* Flashcard View */
                  <div className="max-w-xl mx-auto">
                     <div className="flex justify-between items-center mb-4 text-slate-500 text-sm">
                       <span>บัตรคำที่ {currentCardIndex + 1} จาก {filteredData.length}</span>
                       <span className="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs font-medium">
                         {filteredData[currentCardIndex].category}
                       </span>
                     </div>

                     <div 
                       onClick={flipCard}
                       className="relative h-96 w-full cursor-pointer perspective-1000 group"
                     >
                       <div className={`absolute inset-0 w-full h-full duration-500 preserve-3d transition-all ${isFlipped ? 'rotate-y-180' : ''}`} style={{ transformStyle: 'preserve-3d', transform: isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)' }}>
                         
                         {/* Front of Card */}
                         <div className="absolute inset-0 w-full h-full bg-white rounded-3xl shadow-lg border-2 border-slate-100 flex flex-col items-center justify-center backface-hidden" style={{ backfaceVisibility: 'hidden' }}>
                            <div className="text-9xl font-serif text-slate-800 mb-6">
                              {filteredData[currentCardIndex].char}
                            </div>
                            <p className="text-slate-400 text-sm font-medium animate-pulse">แตะเพื่อดูความหมาย</p>
                         </div>

                         {/* Back of Card */}
                         <div className="absolute inset-0 w-full h-full bg-white rounded-3xl shadow-lg border-2 border-blue-100 flex flex-col items-center justify-center rotate-y-180 backface-hidden" style={{ backfaceVisibility: 'hidden', transform: 'rotateY(180deg)' }}>
                            <div className="w-full flex justify-between items-center px-6 pt-4 pb-2">
                                <h2 className="text-3xl font-bold text-slate-800 text-center flex-1">
                                  {filteredData[currentCardIndex].meaning}
                                </h2>
                            </div>
                            
                            <div className="w-full px-8 space-y-3 pb-6 flex-1 overflow-y-auto">
                              <div className="grid grid-cols-2 gap-3">
                                  <div className="bg-red-50 p-2 rounded-xl border border-red-100 text-center">
                                    <span className="block text-[10px] font-bold text-red-400 uppercase mb-1">On-yomi</span>
                                    <span className="text-sm font-mono text-slate-700">{filteredData[currentCardIndex].on || '-'}</span>
                                  </div>
                                  
                                  <div className="bg-blue-50 p-2 rounded-xl border border-blue-100 text-center">
                                    <span className="block text-[10px] font-bold text-blue-400 uppercase mb-1">Kun-yomi</span>
                                    <span className="text-sm font-mono text-slate-700">{filteredData[currentCardIndex].kun || '-'}</span>
                                  </div>
                              </div>

                              {/* Example Sentence Section in Flashcard */}
                              {filteredData[currentCardIndex].example && (
                                <div className="bg-slate-50 border border-slate-100 rounded-lg p-3 text-left mt-2">
                                    <div className="flex items-center gap-1 mb-1 text-slate-400">
                                        <Lightbulb size={12} />
                                        <span className="text-[10px] font-bold uppercase">ตัวอย่าง</span>
                                    </div>
                                    <div className="text-sm text-slate-800 mb-1">{filteredData[currentCardIndex].example}</div>
                                    <div className="text-[10px] text-slate-500 italic">{filteredData[currentCardIndex].exampleReading}</div>
                                    <div className="text-[10px] text-slate-600 border-t border-slate-100 mt-1 pt-1">{filteredData[currentCardIndex].exampleMeaning}</div>
                                </div>
                              )}
                            </div>
                         </div>

                       </div>
                     </div>

                     {/* Controls */}
                     <div className="flex justify-between items-center mt-8 px-4">
                       <button 
                         onClick={prevCard}
                         className="p-4 rounded-full bg-white shadow-md text-slate-600 hover:text-blue-600 hover:bg-blue-50 transition-all active:scale-95"
                       >
                         <ChevronLeft size={28} />
                       </button>

                       <button 
                        onClick={flipCard}
                        className="px-8 py-3 bg-slate-800 text-white rounded-full font-medium shadow-md hover:bg-slate-700 transition-colors"
                       >
                        {isFlipped ? 'ดูคันจิ' : 'ดูเฉลย'}
                       </button>

                       <button 
                         onClick={nextCard}
                         className="p-4 rounded-full bg-white shadow-md text-slate-600 hover:text-blue-600 hover:bg-blue-50 transition-all active:scale-95"
                       >
                         <ChevronRight size={28} />
                       </button>
                     </div>
                  </div>
                )}

              </main>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>